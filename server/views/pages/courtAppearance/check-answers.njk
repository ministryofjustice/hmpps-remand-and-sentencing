{% extends "../../partials/prisonerBannerBackLayout.njk" %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}

{% set checkAnswersRows = [
                        {
                            key: {
                            text: "Court case reference"
                        },
                            value: {
                            text: courtAppearance.caseReferenceNumber
                        },
                            actions: {
                            items: [
                                {
                                    href: "/person/" + nomsId + "/" + addOrEditCourtCase + "/" +courtCaseReference + "/appearance/" + appearanceReference + "/reference?submitToCheckAnswers=true",
                                    text: "Edit",
                                    visuallyHiddenText: "court case reference number"
                                }
                            ]
                        }
                        },
                        {
                            key: {
                            text: "Warrant date"
                        },
                            value: {
                            text: courtAppearance.warrantDate | formatDate
                        },
                            actions: {
                            items: [
                                {
                                    href: "/person/" + nomsId + "/" + addOrEditCourtCase + "/" +courtCaseReference + "/appearance/" + appearanceReference + "/warrant-date?submitToCheckAnswers=true",
                                    text: "Edit",
                                    visuallyHiddenText: "warrant date"
                                }
                            ]
                        }
                        },
                        {
                            key: {
                            text: "Court name"
                        },
                            value: {
                            text: courtAppearance.courtName
                        },
                            actions: {
                            items: [
                                {
                                    href: "/person/" + nomsId + "/" + addOrEditCourtCase + "/" +courtCaseReference + "/appearance/" + appearanceReference + "/court-name?submitToCheckAnswers=true",
                                    text: "Edit",
                                    visuallyHiddenText: "court name"
                                }
                            ]
                        }
                        },
                        {
                            key: {
                            text: "Overall case outcome"
                        },
                            value: {
                            text: courtAppearance.overallCaseOutcome
                        },
                            actions: {
                            items: [
                                {
                                    href: "/person/" + nomsId + "/" + addOrEditCourtCase + "/" +courtCaseReference + "/appearance/" + appearanceReference + "/overall-case-outcome?submitToCheckAnswers=true",
                                    text: "Edit",
                                    visuallyHiddenText: "overall case outcome"
                                }
                            ]
                        }
                        },
                        {
                            key: {
                            text: "Outcome applies to all offences"
                        },
                            value: {
                            text: "Yes" if courtAppearance.caseOutcomeAppliedAll else "No"
                        },
                            actions: {
                            items: [
                                {
                                    href: "/person/" + nomsId + "/" + addOrEditCourtCase + "/" + courtCaseReference + "/appearance/" + appearanceReference + "/case-outcome-applied-all?submitToCheckAnswers=true",
                                    text: "Edit",
                                    visuallyHiddenText: "edit outcome applies to all offences"
                                }
                            ]
                        }
                        },
                        {
                            key: {
                            text: "Tagged bail"
                        },
                            value: {
                            text: courtAppearance.taggedBail + " days" if courtAppearance.taggedBail else "None"
                        },
                            actions: {
                            items: [
                                {
                                    href: "/person/" + nomsId + "/" + addOrEditCourtCase + "/" +courtCaseReference + "/appearance/" + appearanceReference + "/tagged-bail?submitToCheckAnswers=true",
                                    text: "Edit",
                                    visuallyHiddenText: "edit tagged bail"
                                }
                            ]
                        }
                        }

                    ] %}

{% if courtAppearance.overallSentenceLength %}

{% set overallSentenceLengthValue = '' %}
    {% for order in courtAppearance.overallSentenceLength.periodOrder %}
        {% set overallSentenceLengthValue = overallSentenceLengthValue + ' ' + courtAppearance.overallSentenceLength[order] + ' ' + order %}
    {% endfor %}

    {% set checkAnswersRows = (checkAnswersRows.push({
                            key: {
                            text: "Overall sentence length"
                        },
                            value: {
                            text: overallSentenceLengthValue
                        },
                            actions: {
                            items: [
                                {
                                    href: "/person/" + nomsId + "/" + addOrEditCourtCase + "/" +courtCaseReference + "/appearance/" + appearanceReference + "/overall-sentence-length?submitToCheckAnswers=true",
                                    text: "Edit",
                                    visuallyHiddenText: "edit overall sentence length"
                                }
                            ]
                        }
                        }), checkAnswersRows)%}
{% endif %}


{% set pageTitle = applicationName + " - Check court appearance answers" %}

{% block content %}
    <div class="govuk-grid-row govuk-!-margin-top-4">
        <div class="govuk-grid-column-two-thirds">
                {% include "../../partials/appearanceCaption.njk" %}
                <h1 class="govuk-heading-l">Check your answers</h1>

                {{ govukSummaryList({
                    rows: checkAnswersRows
                }) }}

            <form method="post" action="/person/{{ nomsId }}/{{ addOrEditCourtCase }}/{{ courtCaseReference }}/appearance/{{ appearanceReference }}/submit-check-answers">
                <input type="hidden" name="_csrf" value="{{ csrfToken }}">
                {{ govukButton({
                    text: "Accept and continue"
                }) }}
            </form>

        </div>
    </div>

{% endblock %}