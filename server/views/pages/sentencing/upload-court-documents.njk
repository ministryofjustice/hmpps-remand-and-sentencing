{% extends "../../partials/appearanceDetailsLayout.njk" %}
{% from "govuk/components/button/macro.njk" import govukButton %}

{% set pageTitle = applicationName + " - upload court documents" %}

{% block pageContent %}
  <h1 class="govuk-heading-l">Upload court documents</h1>
  <p class="govuk-caption-l">
    Uploading documents is optional. The selected file type should be among .PDF, .JPG, .DOC and .DOCX under 50MB.
  </p>

  {% set documentTypesToDisplay = [
    { type: "HMCTS_WARRANT", name: "Sentencing warrant", uploadLinkSegment: "warrant" },
    { type: "TRIAL_RECORD_SHEET", name: "Trial record sheet", uploadLinkSegment: "trial-record-sheet" },
    { type: "INDICTMENT", name: "Indictment", uploadLinkSegment: "indictment" },
    { type: "PRISON_COURT_REGISTER", name: "Prison court register", uploadLinkSegment: "prison-court-register" }
  ] %}

  {% for docTypeInfo in documentTypesToDisplay %}
    {% set foundDoc = none %}

    {% for uploadedItem in uploadedDocuments %}
      {% if uploadedItem.documentType == docTypeInfo.type %}
        {% set foundDoc = uploadedItem %}
      {% endif %}
    {% endfor %}

{% if not foundDoc %}
    <h2 class="govuk-heading-m govuk-!-margin-bottom-2">{{ docTypeInfo.name }}</h2>
{% endif %}

    {% if foundDoc %}
        <dl class="govuk-summary-list govuk-summary-list--long-key govuk-!-margin-bottom-0">
              <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                  <a class="govuk-link" href=""><strong>{{ foundDoc.fileName }}</strong></a>
                </dt>
                <dd class="govuk-summary-list__value">
                  <strong class="govuk-tag govuk-tag--green">Uploaded</strong>
                </dd>
                <dd class="govuk-summary-list__actions">
                  <a class="govuk-link" href="/person/{{ nomsId }}/{{ addOrEditCourtCase }}/{{ courtCaseReference }}/{{ addOrEditCourtAppearance }}/{{ appearanceReference }}/{{ foundDoc.documentId }}/delete-document">Remove</a>
                </dd>
              </div>
        </dl>
    {% else %}
      <p class="govuk-body">
        <a class="govuk-link" href="/person/{{ nomsId }}/{{ addOrEditCourtCase }}/{{ courtCaseReference }}/{{ addOrEditCourtAppearance }}/{{ appearanceReference }}/{{ docTypeInfo.uploadLinkSegment }}/upload-documents?_csrf={{ csrfToken }}">Upload {{ docTypeInfo.name | lower }}</a>
      </p>
    {% endif %}

    {% if not loop.last %}
      <hr class="govuk-!-margin-top-4 govuk-!-margin-bottom-4">
    {% endif %}
  {% endfor %}

  <form method="post" action="/person/{{ nomsId }}/{{ addOrEditCourtCase }}/{{ courtCaseReference }}/{{ addOrEditCourtAppearance }}/{{ appearanceReference }}/submit-check-answers">
    <input type="hidden" name="_csrf" value="{{ csrfToken }}">
    {{ govukButton({
        text: "Continue",
        attributes: { 'data-qa': 'continue-button' }
    }) }}
  </form>
{% endblock %}